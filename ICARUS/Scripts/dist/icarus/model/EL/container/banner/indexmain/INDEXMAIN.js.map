{"version":3,"sources":["model/EL/container/banner/indexmain/INDEXMAIN.js"],"names":["BANNER","BUTTON","BUTTONGROUP","FOOTER","HEADER","IFRAME","MODAL","MODEL","THUMBNAIL","INDEXMAIN","[object Object]","node","model","super","this","addClass","page","pageLength","pageTotal","header","$","el","insertBefore","body","pane","pagination","createPaginationFooter","footer","insertAfter","loadPage","isNaN","console","log","post","__RequestVerificationToken","getMainContainer","token","payload","status","total","l","list","length","thumb","set","label","dataId","data","p","id","className","index","buttonGroup","removeClass","button","onclick","launchMain","loaded","pageCount","Math","ceil","addButton","setAttribute","btnPrev","prevPage","bind","btnNext","nextPage","setInnerHTML","buttons","children","b","empty","construct","e","modal","iframe","container","src","url","origin","frame","show"],"mappings":"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","file":"INDEXMAIN.js","sourcesContent":["/**\r\n    @module\r\n*/\r\nimport BANNER from '../BANNER.js';\r\nimport BUTTON from '../../../button/BUTTON.js';\r\nimport BUTTONGROUP from '../../../group/buttongroup/BUTTONGROUP.js';\r\nimport FOOTER from '../../../footer/FOOTER.js';\r\nimport HEADER from '../../../header/HEADER.js';\r\nimport IFRAME from '../../iframe/IFRAME.js';\r\nimport MODAL from '../../../modal/MODAL.js';\r\nimport MODEL from '../../../../MODEL.js';\r\n//import P from '../../../p/P.js';\r\nimport THUMBNAIL from '../thumbnail/THUMBNAIL.js';\r\n//import TOKEN from '../../formelement/input/TOKEN.js';\r\n/**\r\n    Contains a high level view of all MAIN Objects available to this user\r\n    @class\r\n    @extends BANNER\r\n*/\r\nexport default class INDEXMAIN extends BANNER {\r\n\t/**\r\n\t    Constructs a SECTION Container Element\r\n\t    @param {CONTAINER} node Parent node\r\n\t    @param {MODEL} model INDEX model\r\n\t */\r\n\tconstructor(node, model) {\r\n\t\tsuper(node, model);\r\n\t\tthis.addClass('index-main');\r\n\t\t//this.populate(model.children);\r\n\t\tthis.page = 0;\r\n\t\tthis.pageLength = 6;\r\n\t\tthis.pageTotal = 0;\r\n\t\t//if (this.dataId > 0) {    }\r\n\t\tthis.header = new HEADER(this, new MODEL());\r\n\t\t$(this.header.el).insertBefore(this.body.pane.el);\r\n\t\tthis.pagination = this.createPaginationFooter();\r\n\t\t//$(this.pagination.el).insertBefore(this.body.pane.el);\r\n\t\tthis.footer = new FOOTER(this, new MODEL());\r\n\t\t$(this.pagination.el).insertAfter(this.body.pane.el);\r\n\t\tthis.loadPage(this.page);\r\n\t}\r\n\t/**\r\n\t\t    Constructs the INDEXMAIN Container\r\n\t        @returns {void}\r\n\t\t*/\r\n\tconstruct() {\r\n\t\tif (!isNaN(this.page)) {\r\n\t\t\tconsole.log('Retrieving page ' + this.page);\r\n\t\t\t//let token = TOKEN.getToken();\r\n\t\t\t$.post('/Main/PageIndex?page=' + this.page + '&pageLength=' + this.pageLength, {\r\n\t\t\t\t'__RequestVerificationToken': this.getMainContainer().token // this.token.value\r\n\t\t\t}, (payload, status) => {\r\n\t\t\t\tif (status === 'success') {\r\n\t\t\t\t\tthis.pageTotal = payload.total;\r\n\t\t\t\t\tfor (let l = 0; l < payload.list.length; l++) {\r\n\t\t\t\t\t\tlet thumb = new THUMBNAIL(this.body.pane, new MODEL().set({\r\n\t\t\t\t\t\t\t'label': payload.list[l].label,\r\n\t\t\t\t\t\t\t'dataId': -1,\r\n\t\t\t\t\t\t\t'data': {\r\n\t\t\t\t\t\t\t\t'header': payload.list[l].label,\r\n\t\t\t\t\t\t\t\t'p': 'Launch ' + payload.list[l].label + ' (' + payload.list[l].id + ')<br>' + payload.className + '[' + payload.list[l].index + ']'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t//thumb.image.el.setAttribute('style', 'display:none;');\r\n\t\t\t\t\t\tthumb.buttonGroup.removeClass('btn-block');\r\n\t\t\t\t\t\tthumb.button.el.onclick = () => {\r\n\t\t\t\t\t\t\tthis.launchMain(payload.list[l].id, payload.list[l].label);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.pagination.buttonGroup.loaded) {\r\n\t\t\t\t\t\tconsole.log('Page Total: ' + this.pageTotal + ', Length: ' + this.pageLength);\r\n\t\t\t\t\t\tthis.pageCount = Math.ceil(this.pageTotal / this.pageLength);\r\n\t\t\t\t\t\tconsole.log('PageCount: ' + this.pageCount + ', (' + this.pageTotal / this.pageLength + ')');\r\n\t\t\t\t\t\tfor (let p = 0; p < this.pageCount; p++) {\r\n\t\t\t\t\t\t\tlet btn = this.pagination.buttonGroup.addButton(p + 1);\r\n\t\t\t\t\t\t\tbtn.el.onclick = () => {\r\n\t\t\t\t\t\t\t\tthis.loadPage(p);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.pagination.buttonGroup.loaded = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t/*else {\r\n\t\t\tlet note = new P(this.body.pane, new MODEL(), 'No Containers Exist');\r\n\t\t}*/\r\n\t}\r\n\t/**\r\n\t    Creates a Pagination Footer\r\n\t    @returns {FOOTER} A pagination Footer\r\n\t*/\r\n\tcreatePaginationFooter() {\r\n\t\tlet pagination = new FOOTER(this, new MODEL('pagination'));\r\n\t\tpagination.el.setAttribute('style', 'text-align:center;');\r\n\t\tpagination.btnPrev = new BUTTON(pagination, 'Prev');\r\n\t\tpagination.btnPrev.el.setAttribute('style', 'margin-right:1em;');\r\n\t\tpagination.btnPrev.el.onclick = this.prevPage.bind(this);\r\n\t\tpagination.buttonGroup = new BUTTONGROUP(pagination);\r\n\t\tpagination.buttonGroup.loaded = false;\r\n\t\tpagination.btnNext = new BUTTON(pagination, 'Next');\r\n\t\tpagination.btnNext.el.setAttribute('style', 'margin-left:1em;');\r\n\t\tpagination.btnNext.el.onclick = this.nextPage.bind(this);\r\n\t\treturn pagination;\r\n\t}\r\n\t/**\r\n\t    Loads the page\r\n\t    @param {number} page Page to load\r\n\t    @returns {void}\r\n\t*/\r\n\tloadPage(page) {\r\n\t\tconsole.log('Loading page ' + page);\r\n\t\ttry {\r\n\t\t\tthis.header.setInnerHTML('Page ' + (page + 1));\r\n\t\t\tlet buttons = this.pagination.buttonGroup.el.children;\r\n\t\t\tfor (let b = 0; b < buttons.length; b++) {\r\n\t\t\t\t$(buttons[b]).removeClass('active');\r\n\t\t\t}\r\n\t\t\t//console.log('Activating button[' + page + ']');\r\n\t\t\t$(buttons[page]).addClass('active');\r\n\t\t\tthis.body.pane.empty();\r\n\t\t\tthis.page = page;\r\n\t\t\tthis.construct();\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('Unable to load page.', e);\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t    Loads the next page in sequence\r\n\t    @returns {void}\r\n\t*/\r\n\tnextPage() {\r\n\t\tif (this.pageTotal > this.page * this.pageLength + 1) {\r\n\t\t\tthis.loadPage(this.page + 1);\r\n\t\t} else {\r\n\t\t\tconsole.log('No next pages to display');\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t\t    Loads the previous page\r\n\t        @returns {void}\r\n\t\t*/\r\n\tprevPage() {\r\n\t\tif (this.page > 0) {\r\n\t\t\tthis.loadPage(this.page - 1);\r\n\t\t} else {\r\n\t\t\tconsole.log('No previous pages to display');\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t\t    Opens the given Main Id in a new window\r\n\t\t    @param {number} id Main Container Id\r\n\t\t    @param {string} label Main Container Label\r\n\t        @returns {void}\r\n\t\t*/\r\n\tlaunchMain(id, label) {\r\n\t\tconsole.log('Launch Index IFrame Modal');\r\n\t\tthis.modal = new MODAL(label);\r\n\t\tthis.iframe = new IFRAME(this.modal.container.body.pane, new MODEL().set({\r\n\t\t\t'label': 'iframe',\r\n\t\t\t'dataId': -1,\r\n\t\t\t'data': {\r\n\t\t\t\t'src': this.getMainContainer().url.origin + '/' + id\r\n\t\t\t}\r\n\t\t}));\r\n\t\tthis.iframe.frame.el.setAttribute('src', this.getMainContainer().url.origin + '/' + id);\r\n\t\tthis.modal.show();\r\n\t}\r\n\t/**\r\n\t\t    Creates the Modal that contains an iFrame with the given page loaded\r\n\t\t    @todo Consider paging these results\r\n\t        @returns {void}\r\n\t\t*/\r\n\tlaunchModal() {\r\n\t\tconsole.log('Launch Index IFrame Modal');\r\n\t\tthis.modal = new MODAL(this.data.header);\r\n\t\tthis.iframe = new IFRAME(this.modal.container.body.pane, new MODEL().set({\r\n\t\t\t'label': 'iframe'\r\n\t\t}));\r\n\t\tthis.modal.show();\r\n\t}\r\n}"]}
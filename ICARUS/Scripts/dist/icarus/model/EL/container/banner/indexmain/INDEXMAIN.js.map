{"version":3,"sources":["model/EL/container/banner/indexmain/INDEXMAIN.js"],"names":["BANNER","BUTTON","BUTTONGROUP","FOOTER","HEADER","IFRAME","MENU","MODAL","MODEL","THUMBNAIL","INDEXMAIN","[object Object]","node","model","super","this","addClass","page","pageLength","pageTotal","menu","set","label","header","$","el","insertBefore","body","pane","pagination","createPaginationFooter","footer","insertAfter","loadPage","isNaN","console","log","post","__RequestVerificationToken","getMainContainer","token","payload","status","total","l","list","length","thumb","dataId","data","p","id","className","index","buttonGroup","removeClass","button","onclick","launchMain","loaded","pageCount","Math","ceil","addButton","setAttribute","btnPrev","prevPage","bind","btnNext","nextPage","setInnerHTML","buttons","children","b","empty","construct","e","modal","iframe","container","src","url","origin","frame","show"],"mappings":"OACOA,WAAY,sBACZC,WAAY,mCACZC,gBAAiB,mDACjBC,WAAY,mCACZC,WAAY,mCACZC,WAAY,gCACZC,SAAU,mCACVC,UAAW,iCACXC,UAAW,8BACXC,cAAe,2CAKP,MAAMC,kBAAkBV,OAKtCW,YAAYC,EAAMC,GACjBC,MAAMF,EAAMC,GACZE,KAAKC,SAAS,cACdD,KAAKE,KAAO,EACZF,KAAKG,WAAa,EAClBH,KAAKI,UAAY,EACjBJ,KAAKK,KAAO,IAAId,KAAKS,MAAM,IAAIP,OAAQa,IAAI,CAC1CC,MAAS,WAEVP,KAAKQ,OAAS,IAAInB,OAAOW,KAAM,IAAIP,OACnCgB,EAAET,KAAKQ,OAAOE,IAAIC,aAAaX,KAAKY,KAAKC,KAAKH,IAC9CV,KAAKc,WAAad,KAAKe,yBAEvBf,KAAKgB,OAAS,IAAI5B,OAAOY,KAAM,IAAIP,OACnCgB,EAAET,KAAKc,WAAWJ,IAAIO,YAAYjB,KAAKY,KAAKC,KAAKH,IACjDV,KAAKkB,SAASlB,KAAKE,MAMpBN,YACMuB,MAAMnB,KAAKE,QACfkB,QAAQC,IAAI,mBAAqBrB,KAAKE,MAEtCO,EAAEa,KAAK,wBAA0BtB,KAAKE,KAAO,eAAiBF,KAAKG,WAAY,CAC9EoB,2BAA8BvB,KAAKwB,mBAAmBC,OACpD,CAACC,EAASC,KACZ,GAAe,YAAXA,EAAsB,CACzB3B,KAAKI,UAAYsB,EAAQE,MACzB,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAAQI,KAAKC,OAAQF,IAAK,CAC7C,IAAIG,EAAQ,IAAItC,UAAUM,KAAKY,KAAKC,MAAM,IAAIpB,OAAQa,IAAI,CACzDC,MAASmB,EAAQI,KAAKD,GAAGtB,MACzB0B,QAAW,EACXC,KAAQ,CACP1B,OAAUkB,EAAQI,KAAKD,GAAGtB,MAC1B4B,EAAK,UAAYT,EAAQI,KAAKD,GAAGtB,MAAQ,KAAOmB,EAAQI,KAAKD,GAAGO,GAAK,QAAUV,EAAQW,UAAY,IAAMX,EAAQI,KAAKD,GAAGS,MAAQ,QAGnIN,EAAMO,YAAYC,YAAY,aAC9BR,EAAMS,OAAO/B,GAAGgC,QAAU,MACzB1C,KAAK2C,WAAWjB,EAAQI,KAAKD,GAAGO,GAAIV,EAAQI,KAAKD,GAAGtB,SAGtD,IAAKP,KAAKc,WAAWyB,YAAYK,OAAQ,CACxCxB,QAAQC,IAAI,eAAiBrB,KAAKI,UAAY,aAAeJ,KAAKG,YAClEH,KAAK6C,UAAYC,KAAKC,KAAK/C,KAAKI,UAAYJ,KAAKG,YACjDiB,QAAQC,IAAI,cAAgBrB,KAAK6C,UAAY,MAAQ7C,KAAKI,UAAYJ,KAAKG,WAAa,KACxF,IAAK,IAAIgC,EAAI,EAAGA,EAAInC,KAAK6C,UAAWV,IAAK,CAC9BnC,KAAKc,WAAWyB,YAAYS,UAAUb,EAAI,GAChDzB,GAAGgC,QAAU,MAChB1C,KAAKkB,SAASiB,KAGhBnC,KAAKc,WAAWyB,YAAYK,QAAS,OAY1ChD,yBACC,IAAIkB,EAAa,IAAI1B,OAAOY,KAAM,IAAIP,MAAM,eAU5C,OATAqB,EAAWJ,GAAGuC,aAAa,QAAS,sBACpCnC,EAAWoC,QAAU,IAAIhE,OAAO4B,EAAY,QAC5CA,EAAWoC,QAAQxC,GAAGuC,aAAa,QAAS,qBAC5CnC,EAAWoC,QAAQxC,GAAGgC,QAAU1C,KAAKmD,SAASC,KAAKpD,MACnDc,EAAWyB,YAAc,IAAIpD,YAAY2B,GACzCA,EAAWyB,YAAYK,QAAS,EAChC9B,EAAWuC,QAAU,IAAInE,OAAO4B,EAAY,QAC5CA,EAAWuC,QAAQ3C,GAAGuC,aAAa,QAAS,oBAC5CnC,EAAWuC,QAAQ3C,GAAGgC,QAAU1C,KAAKsD,SAASF,KAAKpD,MAC5Cc,EAMRlB,SAASM,GACR,IACCF,KAAKQ,OAAO+C,aAAa,SAAWrD,EAAO,IAC3C,IAAIsD,EAAUxD,KAAKc,WAAWyB,YAAY7B,GAAG+C,SAC7C,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAQzB,OAAQ2B,IACnCjD,EAAE+C,EAAQE,IAAIlB,YAAY,UAG3B/B,EAAE+C,EAAQtD,IAAOD,SAAS,UAC1BD,KAAKY,KAAKC,KAAK8C,QACf3D,KAAKE,KAAOA,EACZF,KAAK4D,YACJ,MAAOC,GACRzC,QAAQC,IAAI,uBAAwBwC,IAMtCjE,WACKI,KAAKI,UAAYJ,KAAKE,KAAOF,KAAKG,WAAa,EAClDH,KAAKkB,SAASlB,KAAKE,KAAO,GAE1BkB,QAAQC,IAAI,4BAOdzB,WACKI,KAAKE,KAAO,EACfF,KAAKkB,SAASlB,KAAKE,KAAO,GAE1BkB,QAAQC,IAAI,gCAQdzB,WAAWwC,EAAI7B,GACda,QAAQC,IAAI,6BACZrB,KAAK8D,MAAQ,IAAItE,MAAMe,GACvBP,KAAK+D,OAAS,IAAIzE,OAAOU,KAAK8D,MAAME,UAAUpD,KAAKC,MAAM,IAAIpB,OAAQa,IAAI,CACxEC,MAAS,SACT0B,QAAW,EACXC,KAAQ,CACP+B,IAAOjE,KAAKwB,mBAAmB0C,IAAIC,OAAS,IAAM/B,MAGpDpC,KAAK+D,OAAOK,MAAM1D,GAAGuC,aAAa,MAAOjD,KAAKwB,mBAAmB0C,IAAIC,OAAS,IAAM/B,GACpFpC,KAAK8D,MAAMO,OAMZzE,cACCwB,QAAQC,IAAI,6BACZrB,KAAK8D,MAAQ,IAAItE,MAAMQ,KAAKkC,KAAK1B,QACjCR,KAAK+D,OAAS,IAAIzE,OAAOU,KAAK8D,MAAME,UAAUpD,KAAKC,MAAM,IAAIpB,OAAQa,IAAI,CACxEC,MAAS,YAEVP,KAAK8D,MAAMO","file":"INDEXMAIN.js","sourcesContent":["/** @module */\r\nimport BANNER from '../BANNER.js';\r\nimport BUTTON from '../../../button/BUTTON.js';\r\nimport BUTTONGROUP from '../../../group/buttongroup/BUTTONGROUP.js';\r\nimport FOOTER from '../../../footer/FOOTER.js';\r\nimport HEADER from '../../../header/HEADER.js';\r\nimport IFRAME from '../../iframe/IFRAME.js';\r\nimport MENU from '../../../nav/menu/MENU.js';\r\nimport MODAL from '../../../modal/MODAL.js';\r\nimport MODEL from '../../../../MODEL.js';\r\nimport THUMBNAIL from '../thumbnail/THUMBNAIL.js';\r\n/** Contains a high level view of all MAIN Objects available to this user\r\n    @class\r\n    @extends BANNER\r\n*/\r\nexport default class INDEXMAIN extends BANNER {\r\n\t/** Constructs a SECTION Container Element\r\n\t    @param {CONTAINER} node Parent node\r\n\t    @param {MODEL} model INDEX model\r\n\t */\r\n\tconstructor(node, model) {\r\n\t\tsuper(node, model);\r\n\t\tthis.addClass('index-main');\r\n\t\tthis.page = 0;\r\n\t\tthis.pageLength = 6;\r\n\t\tthis.pageTotal = 0;\r\n\t\tthis.menu = new MENU(this, new MODEL().set({\r\n\t\t\t'label': 'INDEX'\r\n\t\t}));\r\n\t\tthis.header = new HEADER(this, new MODEL());\r\n\t\t$(this.header.el).insertBefore(this.body.pane.el);\r\n\t\tthis.pagination = this.createPaginationFooter();\r\n\t\t//$(this.pagination.el).insertBefore(this.body.pane.el);\r\n\t\tthis.footer = new FOOTER(this, new MODEL());\r\n\t\t$(this.pagination.el).insertAfter(this.body.pane.el);\r\n\t\tthis.loadPage(this.page);\r\n\t}\r\n\t/**\r\n\t\t    Constructs the INDEXMAIN Container\r\n\t        @returns {void}\r\n\t\t*/\r\n\tconstruct() {\r\n\t\tif (!isNaN(this.page)) {\r\n\t\t\tconsole.log('Retrieving page ' + this.page);\r\n\t\t\t//let token = TOKEN.getToken();\r\n\t\t\t$.post('/Main/PageIndex?page=' + this.page + '&pageLength=' + this.pageLength, {\r\n\t\t\t\t'__RequestVerificationToken': this.getMainContainer().token // this.token.value\r\n\t\t\t}, (payload, status) => {\r\n\t\t\t\tif (status === 'success') {\r\n\t\t\t\t\tthis.pageTotal = payload.total;\r\n\t\t\t\t\tfor (let l = 0; l < payload.list.length; l++) {\r\n\t\t\t\t\t\tlet thumb = new THUMBNAIL(this.body.pane, new MODEL().set({\r\n\t\t\t\t\t\t\t'label': payload.list[l].label,\r\n\t\t\t\t\t\t\t'dataId': -1,\r\n\t\t\t\t\t\t\t'data': {\r\n\t\t\t\t\t\t\t\t'header': payload.list[l].label,\r\n\t\t\t\t\t\t\t\t'p': 'Launch ' + payload.list[l].label + ' (' + payload.list[l].id + ')<br>' + payload.className + '[' + payload.list[l].index + ']'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t\tthumb.buttonGroup.removeClass('btn-block');\r\n\t\t\t\t\t\tthumb.button.el.onclick = () => {\r\n\t\t\t\t\t\t\tthis.launchMain(payload.list[l].id, payload.list[l].label);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.pagination.buttonGroup.loaded) {\r\n\t\t\t\t\t\tconsole.log('Page Total: ' + this.pageTotal + ', Length: ' + this.pageLength);\r\n\t\t\t\t\t\tthis.pageCount = Math.ceil(this.pageTotal / this.pageLength);\r\n\t\t\t\t\t\tconsole.log('PageCount: ' + this.pageCount + ', (' + this.pageTotal / this.pageLength + ')');\r\n\t\t\t\t\t\tfor (let p = 0; p < this.pageCount; p++) {\r\n\t\t\t\t\t\t\tlet btn = this.pagination.buttonGroup.addButton(p + 1);\r\n\t\t\t\t\t\t\tbtn.el.onclick = () => {\r\n\t\t\t\t\t\t\t\tthis.loadPage(p);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.pagination.buttonGroup.loaded = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t/*else {\r\n\t\t\tlet note = new P(this.body.pane, new MODEL(), 'No Containers Exist');\r\n\t\t}*/\r\n\t}\r\n\t/** Creates a Pagination Footer\r\n\t    @returns {FOOTER} A pagination Footer\r\n\t*/\r\n\tcreatePaginationFooter() {\r\n\t\tlet pagination = new FOOTER(this, new MODEL('pagination'));\r\n\t\tpagination.el.setAttribute('style', 'text-align:center;');\r\n\t\tpagination.btnPrev = new BUTTON(pagination, 'Prev');\r\n\t\tpagination.btnPrev.el.setAttribute('style', 'margin-right:1em;');\r\n\t\tpagination.btnPrev.el.onclick = this.prevPage.bind(this);\r\n\t\tpagination.buttonGroup = new BUTTONGROUP(pagination);\r\n\t\tpagination.buttonGroup.loaded = false;\r\n\t\tpagination.btnNext = new BUTTON(pagination, 'Next');\r\n\t\tpagination.btnNext.el.setAttribute('style', 'margin-left:1em;');\r\n\t\tpagination.btnNext.el.onclick = this.nextPage.bind(this);\r\n\t\treturn pagination;\r\n\t}\r\n\t/** Loads the page\r\n\t    @param {number} page Page to load\r\n\t    @returns {void}\r\n\t*/\r\n\tloadPage(page) {\r\n\t\ttry {\r\n\t\t\tthis.header.setInnerHTML('Page ' + (page + 1));\r\n\t\t\tlet buttons = this.pagination.buttonGroup.el.children;\r\n\t\t\tfor (let b = 0; b < buttons.length; b++) {\r\n\t\t\t\t$(buttons[b]).removeClass('active');\r\n\t\t\t}\r\n\t\t\t//console.log('Activating button[' + page + ']');\r\n\t\t\t$(buttons[page]).addClass('active');\r\n\t\t\tthis.body.pane.empty();\r\n\t\t\tthis.page = page;\r\n\t\t\tthis.construct();\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('Unable to load page.', e);\r\n\t\t}\r\n\t}\r\n\t/** Loads the next page in sequence\r\n\t    @returns {void}\r\n\t*/\r\n\tnextPage() {\r\n\t\tif (this.pageTotal > this.page * this.pageLength + 1) {\r\n\t\t\tthis.loadPage(this.page + 1);\r\n\t\t} else {\r\n\t\t\tconsole.log('No next pages to display');\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t\t    Loads the previous page\r\n\t        @returns {void}\r\n\t\t*/\r\n\tprevPage() {\r\n\t\tif (this.page > 0) {\r\n\t\t\tthis.loadPage(this.page - 1);\r\n\t\t} else {\r\n\t\t\tconsole.log('No previous pages to display');\r\n\t\t}\r\n\t}\r\n\t/** Opens the given Main Id in a new window\r\n\t\t@param {number} id Main Container Id\r\n\t\t@param {string} label Main Container Label\r\n\t    @returns {void}\r\n\t*/\r\n\tlaunchMain(id, label) {\r\n\t\tconsole.log('Launch Index IFrame Modal');\r\n\t\tthis.modal = new MODAL(label);\r\n\t\tthis.iframe = new IFRAME(this.modal.container.body.pane, new MODEL().set({\r\n\t\t\t'label': 'iframe',\r\n\t\t\t'dataId': -1,\r\n\t\t\t'data': {\r\n\t\t\t\t'src': this.getMainContainer().url.origin + '/' + id\r\n\t\t\t}\r\n\t\t}));\r\n\t\tthis.iframe.frame.el.setAttribute('src', this.getMainContainer().url.origin + '/' + id);\r\n\t\tthis.modal.show();\r\n\t}\r\n\t/** Creates the Modal that contains an iFrame with the given page loaded\r\n\t\t@todo Consider paging these results\r\n\t    @returns {void}\r\n\t*/\r\n\tlaunchModal() {\r\n\t\tconsole.log('Launch Index IFrame Modal');\r\n\t\tthis.modal = new MODAL(this.data.header);\r\n\t\tthis.iframe = new IFRAME(this.modal.container.body.pane, new MODEL().set({\r\n\t\t\t'label': 'iframe'\r\n\t\t}));\r\n\t\tthis.modal.show();\r\n\t}\r\n}"]}
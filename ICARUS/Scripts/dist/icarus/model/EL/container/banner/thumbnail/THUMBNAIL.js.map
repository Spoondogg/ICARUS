{"version":3,"sources":["model/EL/container/banner/thumbnail/THUMBNAIL.js"],"names":["NAVITEM","ATTRIBUTES","EL","MODEL","HEADER","IMG","P","STRING","THUMBNAIL","[object Object]","node","model","super","this","addClass","image","anchor","$","el","insertBefore","label","header","set","p","truncate","fetchImage","dataId","parsed","data","img","Number","isInteger","parseInt","getJSON","jsonResults","JSON","parse","forEach","name","value","src","showImageDetails","e","console","log","setAttribute","innerHTML","filename","id","fileSize","dimX","dimY","fileType","ee"],"mappings":"OACOA,SAAWC,WAAYC,GAAIC,UAAa,yCACxCC,WAAY,mCACZC,QAAS,6BACTC,MAAO,yBACPC,WAAY,0CAKJ,MAAMC,kBAAkBR,QAKtCS,YAAYC,EAAMC,GACXC,MAAMF,EAAMC,GACZE,KAAKC,SAAS,gDACdD,KAAKE,MAAQ,IAAIV,IAAIQ,KAAKG,OAAQ,IAAIb,OACtCc,EAAEJ,KAAKE,MAAMG,IAAIC,aAAaN,KAAKG,OAAOI,MAAMF,IAChDL,KAAKQ,OAAS,IAAIjB,OAAOS,KAAKG,QAAQ,IAAIb,OAAQmB,IAAI,CAAEF,MAAS,qBACjEP,KAAKU,EAAI,IAAIjB,EAAEO,KAAKG,OAAQ,IAAIb,MAAS,IAAII,OAAO,wBAAwBiB,SAAS,MACrFX,KAAKY,aAKThB,aACI,GAAII,KAAKa,OAAS,IAAsB,IAAjBb,KAAKa,OAAe,CACvC,IAAIC,EAAS,KACb,GAAId,KAAKe,KAAKC,IACV,GAAIC,OAAOC,UAAUC,SAASnB,KAAKe,KAAKC,MACpC,IACIZ,EAAEgB,QAAQ,iBAAmBD,SAASnB,KAAKe,KAAKC,KAAOD,IACnD,GAAIA,EAAKjB,OACDiB,EAAKjB,MAAMuB,YAAa,CACxBP,EAASQ,KAAKC,MAAMR,EAAKjB,MAAMuB,aAC/B,IAAIL,EAAM,GACVF,EAAOU,QAAQ,EAAGC,KAAAA,EAAMC,MAAAA,MACpBV,EAAIS,GAAQC,EACC,WAATD,IACAzB,KAAKE,MAAMG,GAAGsB,IAAMX,EAAIS,MAG5BzB,KAAKe,KAAKa,kBACV5B,KAAK4B,iBAAiBZ,MAKxC,MAAOa,GACLC,QAAQC,IAAI,+BAAgCF,QAGhD7B,KAAKE,MAAMG,GAAG2B,aAAa,MAAOhC,KAAKe,KAAKC,MAS5DpB,iBAAiBoB,GACb,IACIhB,KAAKQ,OAAOH,GAAG4B,UAAYjB,EAAIkB,SAC/BlC,KAAKU,EAAEL,GAAG4B,UAAY,OAASjB,EAAImB,GAAK,iBAAmBnB,EAAIoB,SAAW,OAASpB,EAAIqB,KAAO,MAAQrB,EAAIsB,KAAO,QAAUtB,EAAIuB,SACjI,MAAOC,GACLV,QAAQC,IAAI,qCAAsCf,YAIrD5B,WAAYC,GAAIC","file":"THUMBNAIL.js","sourcesContent":["/** @module */\r\nimport NAVITEM, { ATTRIBUTES, EL, MODEL } from '../../../nav/navitem/NAVITEM.js';\r\nimport HEADER from '../../../header/header.js';\r\nimport IMG from '../../../img/IMG.js';\r\nimport P from '../../../p/P.js';\r\nimport STRING from '../../../../../STRING.js';\r\n/** A full-width NavItem with a Thumbnail image, label and description\r\n    @class\r\n    @extends CONTAINER\r\n*/\r\nexport default class THUMBNAIL extends NAVITEM { //CONTAINER {\r\n\t/** Constructs a Bootstrap Jumbotron\r\n        @param {CONTAINER} node The model\r\n        @param {MODEL} model Object Model\r\n    */\r\n\tconstructor(node, model) {\r\n        super(node, model);\r\n        this.addClass('thumbnail col-xs-12 col-sm-6 col-lg-offset-0');\r\n        this.image = new IMG(this.anchor, new MODEL());\r\n        $(this.image.el).insertBefore(this.anchor.label.el);\r\n        this.header = new HEADER(this.anchor, new MODEL().set({ 'label': 'thumbnailheader' }));\r\n        this.p = new P(this.anchor, new MODEL(), new STRING('thumbnaildescription').truncate(128));\r\n        this.fetchImage();\r\n    }\r\n    /** Retrieve a FormPost for the given MAIN and sets this image source\r\n        @returns {void}\r\n    */\r\n    fetchImage() {\r\n        if (this.dataId > 0 || this.dataId === -1) {\r\n            let parsed = null;\r\n            if (this.data.img) {\r\n                if (Number.isInteger(parseInt(this.data.img))) { // If this.data.img is integer, retrieve relevant formpost\r\n                    try { // Test to see if the formpost can be retrieved\r\n                        $.getJSON('/FORMPOST/Get/' + parseInt(this.data.img), (data) => { // If access granted...\r\n                            if (data.model) {\r\n                                if (data.model.jsonResults) {\r\n                                    parsed = JSON.parse(data.model.jsonResults);                                    \r\n                                    let img = {}; // Extract the base64 values and create an image\r\n                                    parsed.forEach(({ name, value }) => {\r\n                                        img[name] = value;\r\n                                        if (name === 'base64') {\r\n                                            this.image.el.src = img[name];\r\n                                        }\r\n                                    });\r\n                                    if (this.data.showImageDetails) {\r\n                                        this.showImageDetails(img);\r\n                                    }\r\n                                }\r\n                            }\r\n                        });\r\n                    } catch (e) {\r\n                        console.log('Unable to retrieve FormPost.', e);\r\n                    }\r\n                } else {\r\n                    this.image.el.setAttribute('src', this.data.img);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /** Appends image metadata to thumbnail\r\n        @param {object} img An image model\r\n        @returns {void}\r\n    */\r\n    showImageDetails(img) {\r\n        try {\r\n            this.header.el.innerHTML = img.filename;\r\n            this.p.el.innerHTML = 'Id: ' + img.id + '<br>Filesize: ' + img.fileSize + 'kb (' + img.dimX + ' x ' + img.dimY + ')<br>' + img.fileType;\r\n        } catch (ee) {\r\n            console.log('Unable to set Thumbnail attributes', img);\r\n        }\r\n    }\r\n}\r\nexport { ATTRIBUTES, EL, MODEL };"]}
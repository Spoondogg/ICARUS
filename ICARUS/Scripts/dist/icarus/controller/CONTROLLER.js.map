{"version":3,"sources":["icarus/controller/CONTROLLER.js"],"names":["MAIN","LOADER","MODEL","CONTAINERFACTORY","WATERMARK","CONTROLLER","[object Object]","id","user","dev","recursionLimit","name","version","token","factory","super","set","this","watermark","url","URL","window","location","href","debug","returnUrl","searchParams","get","origin","loader","log","prompt","main","label","showLoginPrompt","login"],"mappings":"OAGOA,MAAQC,OAAQC,UAAa,4CAC7BC,qBAAsB,+BACtBC,cAAe,wCAQP,MAAMC,mBAAmBH,MAYvCI,YAAYC,EAAK,EAAGC,EAAO,QAASC,GAAM,EAAOC,EAAiB,IAAKC,EAAMC,EAASC,EAAOC,GAC5FC,QAAQC,IAAI,CACXT,GAAAA,EACAC,KAAAA,EACAC,IAAAA,EACAC,eAAAA,EACAC,KAAAA,EACAC,QAAAA,EACAC,MAAAA,EACAC,QAAAA,IAGDG,KAAKC,UAAY,IAAId,UAgBrBa,KAAKE,IAAM,IAAIC,IAAIC,OAAOC,SAASC,MAInCN,KAAKO,OAAQ,EAQbP,KAAKQ,UAAYR,KAAKE,IAAIO,aAAaC,IAAI,aACvCV,KAAKQ,YACRR,KAAKQ,UAAYR,KAAKE,IAAIS,OAASX,KAAKQ,UACxCH,SAASC,KAAON,KAAKQ,WAKtBR,KAAKY,OAAS,IAAI5B,OAAO,UAAW,UAAW,KAC/CgB,KAAKY,OAAOC,IAAI,IAAK,4BAA4B,GAOjDb,KAAKc,OAAS,KAIdd,KAAKe,KAAO,IAAIhC,MAAK,IAAIE,OAAQc,IAAI,CACpCT,GAAAA,EACAC,KAAAA,EACAC,IAAAA,EACAK,QAAAA,EACAD,MAAAA,EACAoB,MAAS,GACTJ,OAAUZ,KAAKY,OAEfV,IAAOF,KAAKE,IACZK,MAASP,KAAKO,MACdd,eAAkBO,KAAKP,kBAEX,UAATF,GACHS,KAAKiB,kBAQP5B,kBAIC,OAHIW,KAAKE,IAAIO,aAAaC,IAAI,UAC7BV,KAAKe,KAAKG,QAEJlB,KAMRX,sBAKC,OAJgBW,KAAKE,IAAIO,aAAaC,IAAI,eAEzCL,SAASC,KAAON,KAAKE,IAAIS,OAASX,KAAKQ,WAEjCR,aAGAd","file":"CONTROLLER.js","sourcesContent":["/** \r\n    @module \r\n*/\r\nimport MAIN, { LOADER, MODEL } from '../model/el/container/main/MAIN.js';\r\nimport CONTAINERFACTORY from './CONTAINERFACTORY.js';\r\nimport WATERMARK from '../helper/WATERMARK.js';\r\n/**\r\n    @class\r\n    @extends MODEL\r\n    @description An Application Class\r\n    Constructs the Application Controller and initializes the MAIN Container\r\n    This should be instantiated during the init phase of the html document\r\n*/\r\nexport default class CONTROLLER extends MODEL {\r\n\t/**\r\n\t\t    Constructs an Application\r\n\t\t    @param {number} id The unique application id\r\n\t\t    @param {string} user A friendly username\r\n\t\t    @param {boolean} dev If true, dev-options are enabled\r\n\t\t    @param {number} recursionLimit The maximum number of recursive loops before an error is thrown\r\n\t        @param {string} name The application name\r\n\t        @param {string} version The application version\r\n\t        @param {string} token The session token\r\n\t        @param {CONTAINERFACTORY} factory The container constructor factory \r\n\t\t*/\r\n\tconstructor(id = 0, user = 'Guest', dev = false, recursionLimit = 100, name, version, token, factory) {\r\n\t\tsuper().set({\r\n\t\t\tid,\r\n\t\t\tuser,\r\n\t\t\tdev,\r\n\t\t\trecursionLimit,\r\n\t\t\tname,\r\n\t\t\tversion,\r\n\t\t\ttoken,\r\n\t\t\tfactory\r\n\t\t});\r\n\t\t//this.factory = new CONTAINERFACTORY();\r\n\t\tthis.watermark = new WATERMARK();\r\n\t\t/**\r\n\t\t\t\t    @property {string} name The application name\r\n\t\t        \r\n\t\t\t\tthis.name = name;*/\r\n\t\t/**\r\n\t\t\t\t    @property {string} version The application version\r\n\t\t        \r\n\t\t\t\tthis.version = version;*/\r\n\t\t/**\r\n\t\t\t\t    @property {string} token The session security token\r\n\t\t        \r\n\t\t\t\tthis.token = token;*/\r\n\t\t/**\r\n\t\t    @property {Url} url An Url object\r\n\t\t*/\r\n\t\tthis.url = new URL(window.location.href);\r\n\t\t/**\r\n\t\t    @property {boolean} debug If true, debug outputs are shown\r\n\t\t*/\r\n\t\tthis.debug = true;\r\n\t\t/**\r\n\t\t\t\t    @property {number} recursionLimit The maximum amount of recursion before throwing an error\r\n\t\t        \r\n\t\t\t\tthis.recursionLimit = recursionLimit;*/\r\n\t\t/**\r\n\t\t    @property {string} returnUrl If a ReturnUrl is provided, redirect to that Url\r\n\t\t*/\r\n\t\tthis.returnUrl = this.url.searchParams.get('ReturnUrl');\r\n\t\tif (this.returnUrl) {\r\n\t\t\tthis.returnUrl = this.url.origin + this.returnUrl;\r\n\t\t\tlocation.href = this.returnUrl;\r\n\t\t}\r\n\t\t/**\r\n\t\t    @property {LOADER} loader The default loader modal\r\n\t\t*/\r\n\t\tthis.loader = new LOADER('Loading', 'Loading', 100);\r\n\t\tthis.loader.log(100, 'Launching application...', true);\r\n\t\t/**\r\n\t\t\t\t    @property {PROMPT} prompt A dialog prompting the user for input\r\n\t\t\t\t    @type {PROMPT}\r\n\t\t\t\t    @todo There should never be more than one prompt in the DOM.\r\n\t\t            @todo Create a queue to hold multiple prompts\r\n\t\t\t\t*/\r\n\t\tthis.prompt = null;\r\n\t\t/**\r\n\t\t    @property {MAIN} main The MAIN Container\r\n\t\t*/\r\n\t\tthis.main = new MAIN(new MODEL().set({\r\n\t\t\tid,\r\n\t\t\tuser,\r\n\t\t\tdev,\r\n\t\t\tfactory,\r\n\t\t\ttoken,\r\n\t\t\t'label': '', //this.name + ' : ' + this.version,\r\n\t\t\t'loader': this.loader,\r\n\t\t\t//'token': this.token,\r\n\t\t\t'url': this.url,\r\n\t\t\t'debug': this.debug,\r\n\t\t\t'recursionLimit': this.recursionLimit\r\n\t\t}));\r\n\t\tif (user === 'Guest') {\r\n\t\t\tthis.showLoginPrompt();\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t    Determines if a 'login' parameter exists in the Url, and if true, \r\n\t    shows the login prompt.\r\n\t    @returns {boolean} If a login parameter exists, return true\r\n\t*/\r\n\tshowLoginPrompt() {\r\n\t\tif (this.url.searchParams.get('login')) {\r\n\t\t\tthis.main.login();\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\t/**\r\n\t    If a ReturnUrl is provided, redirect to that Url\r\n\t    @returns {APP} This APP\r\n\t*/\r\n\tredirectToReturnUrl() {\r\n\t\tlet returnUrl = this.url.searchParams.get('ReturnUrl');\r\n\t\tif (returnUrl) {\r\n\t\t\tlocation.href = this.url.origin + this.returnUrl;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n}\r\nexport { CONTAINERFACTORY };"]}
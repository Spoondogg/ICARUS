@using ICARUS.Models
@model LoginViewModel
@using Microsoft.Owin.Security
@{
    ViewBag.Title = "LogOff";
}
@section viewInit {
    @Html.AntiForgeryToken()
    @if (!User.Identity.IsAuthenticated) {
        <script type="text/javascript">
            const token = document.getElementsByName('__RequestVerificationToken')[0];
            const factory = new CONTAINERFACTORY();
            const user = '@(User.Identity.Name == "" ? "Guest" : User.Identity.Name)';
            const dev = @( User.IsInRole("Dev") ? 1 : User.IsInRole("Admin") ? 1 : 0) ? true : false;
            const app = new MAIN();
            app.logout();
        </script>
    } else {
        <script type="text/javascript">
            const token = document.getElementsByName('__RequestVerificationToken')[0];
            const factory = new CONTAINERFACTORY();
            const user = '@(User.Identity.Name == "" ? "Guest" : User.Identity.Name)';
            const dev = @( User.IsInRole("Dev") ? 1 : User.IsInRole("Admin") ? 1 : 0) ? true : false;
            const app = new MAIN();
            app.loader.log(100, 'You are not logged in.\nRedirecting...');
            setTimeout(function () {
                location.href = '/';
            }, 1000);
        </script>
    }
}
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}